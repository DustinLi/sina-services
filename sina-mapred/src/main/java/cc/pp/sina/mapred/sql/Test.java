package cc.pp.sina.mapred.sql;

import java.sql.SQLException;

import cc.pp.sina.utils.net.Nettool;

public class Test {

	public final static Long[] FANS = { 2618489234L, 2887584704L, 2980226980L, 2027903552L, 3298393123L, 3171870741L,
			2663635275L, 3643090415L, 2818778920L, 2841481311L, 3670543770L, 2035500184L, 2154720702L, 2884207160L,
			2873744617L, 2232894414L, 2507601222L, 3058910673L, 2705002545L, 3561917673L, 2265489502L, 3072202773L,
			2591181340L, 2375084590L, 2215179947L, 2673476341L, 2885465763L, 1338392314L, 3073512871L, 2625479363L,
			2992353152L, 2875606813L, 2582924290L, 2599658301L, 2849801310L, 2459269113L, 3209954413L, 2617641030L,
			1895171942L, 2992107470L, 2750935323L, 2826739445L, 2724204845L, 2702055412L, 2881668352L, 3066334685L,
			2618366395L, 2159486174L, 2984235984L, 2660017947L, 2885548974L, 1151242007L, 2381268587L, 2148223490L,
			1900909045L, 1955160602L, 2715109311L, 1951713414L, 2850258173L, 2163397657L, 3218149391L, 2746231877L,
			2526982651L, 2951488344L, 2159612854L, 2212462505L, 2897464052L, 1424732432L, 2145250073L, 2862958130L,
			2096212631L, 3077610177L, 3173057683L, 1630332870L, 3515665167L, 3630571297L, 1766424842L, 2047370680L,
			2027945855L, 1715719085L, 2866275482L, 1788972652L, 2970915540L, 2849582935L, 1721935401L, 2810730305L,
			1523467655L, 2300696875L, 3045989525L, 2842357717L, 1951647814L, 2760483692L, 1159427160L, 3127824084L,
			1392767582L };

	private WeiboJDBC weiboJDBC;

	public Test() {
		weiboJDBC = new WeiboJDBC(Nettool.getServerLocalIp());
		if (!weiboJDBC.mysqlStatus()) {
			return;
		}
	}

	public void closed() {
		weiboJDBC.sqlClose();
	}

	public static void main(String[] args) throws SQLException {

		Test test = new Test();
		int[] quality = new int[3];
		for (Long uid : FANS) {
			System.out.println(uid);
			quality[test.getWeiboJDBC().sinaUserQualityInfo(uid)]++;
		}
		System.out.println(quality[0]);
		System.out.println(quality[1]);
		System.out.println(quality[2]);

		test.closed();
	}

	public WeiboJDBC getWeiboJDBC() {
		return weiboJDBC;
	}

}
